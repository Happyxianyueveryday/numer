%针对本题的分段三次埃尔米特插值函数
%该分段三次埃尔米特插值函数接受四个参数，其中xi为插值点的列表，yi为插值点的函数值的列表，xi，yi的长度均适应本题要求固定为11
%y1为原函数的一阶导数在各个插值点的函数值，xm为埃尔米特插值多项式待求解的点的多项式值

function y=Section_Hermite(xn,yn,y1,xm)
n=length(xm);
f1 = @(x)(((x-xn(2))/(xn(1)-xn(2))).*((x-xn(2))/(xn(1)-xn(2))).*(1+2.*((x-xn(1))/(xn(2)-xn(1)))).*yn(1)+((x-xn(1))/(xn(2)-xn(1))).*((x-xn(1))/(xn(2)-xn(1))).*(1+2.*(x-xn(2))/(xn(1)-xn(2))).*yn(2)+((x-xn(2))/(xn(1)-xn(2))).*((x-xn(2))/(xn(1)-xn(2))).*(x-xn(1)).*y1(1)+((x-xn(1))/(xn(2)-xn(1))).*((x-xn(1))/(xn(2)-xn(1))).*(x-xn(2)).*y1(2));
f2 = @(x)(((x-xn(3))/(xn(2)-xn(3))).*((x-xn(3))/(xn(2)-xn(3))).*(1+2.*((x-xn(2))/(xn(3)-xn(2)))).*yn(2)+((x-xn(2))/(xn(3)-xn(2))).*((x-xn(2))/(xn(3)-xn(2))).*(1+2.*(x-xn(3))/(xn(2)-xn(3))).*yn(3)+((x-xn(3))/(xn(2)-xn(3))).*((x-xn(3))/(xn(2)-xn(3))).*(x-xn(2)).*y1(2)+((x-xn(2))/(xn(3)-xn(2))).*((x-xn(2))/(xn(3)-xn(2))).*(x-xn(3)).*y1(3));
f3 = @(x)(((x-xn(4))/(xn(3)-xn(4))).*((x-xn(4))/(xn(3)-xn(4))).*(1+2.*((x-xn(3))/(xn(4)-xn(3)))).*yn(3)+((x-xn(3))/(xn(4)-xn(3))).*((x-xn(3))/(xn(4)-xn(3))).*(1+2.*(x-xn(4))/(xn(3)-xn(4))).*yn(4)+((x-xn(4))/(xn(3)-xn(4))).*((x-xn(4))/(xn(3)-xn(4))).*(x-xn(3)).*y1(3)+((x-xn(3))/(xn(4)-xn(3))).*((x-xn(3))/(xn(4)-xn(3))).*(x-xn(4)).*y1(4));
f4 = @(x)(((x-xn(5))/(xn(4)-xn(5))).*((x-xn(5))/(xn(4)-xn(5))).*(1+2.*((x-xn(4))/(xn(5)-xn(4)))).*yn(4)+((x-xn(4))/(xn(5)-xn(4))).*((x-xn(4))/(xn(5)-xn(4))).*(1+2.*(x-xn(5))/(xn(4)-xn(5))).*yn(5)+((x-xn(5))/(xn(4)-xn(5))).*((x-xn(5))/(xn(4)-xn(5))).*(x-xn(4)).*y1(4)+((x-xn(4))/(xn(5)-xn(4))).*((x-xn(4))/(xn(5)-xn(4))).*(x-xn(5)).*y1(5));
f5 = @(x)(((x-xn(6))/(xn(5)-xn(6))).*((x-xn(6))/(xn(5)-xn(6))).*(1+2.*((x-xn(5))/(xn(6)-xn(5)))).*yn(5)+((x-xn(5))/(xn(6)-xn(5))).*((x-xn(5))/(xn(6)-xn(5))).*(1+2.*(x-xn(6))/(xn(5)-xn(6))).*yn(6)+((x-xn(6))/(xn(5)-xn(6))).*((x-xn(6))/(xn(5)-xn(6))).*(x-xn(5)).*y1(5)+((x-xn(5))/(xn(6)-xn(5))).*((x-xn(5))/(xn(6)-xn(5))).*(x-xn(6)).*y1(6));
f6 = @(x)(((x-xn(7))/(xn(6)-xn(7))).*((x-xn(7))/(xn(6)-xn(7))).*(1+2.*((x-xn(6))/(xn(7)-xn(6)))).*yn(6)+((x-xn(6))/(xn(7)-xn(6))).*((x-xn(6))/(xn(7)-xn(6))).*(1+2.*(x-xn(7))/(xn(6)-xn(7))).*yn(7)+((x-xn(7))/(xn(6)-xn(7))).*((x-xn(7))/(xn(6)-xn(7))).*(x-xn(6)).*y1(6)+((x-xn(6))/(xn(7)-xn(6))).*((x-xn(6))/(xn(7)-xn(6))).*(x-xn(7)).*y1(7));    
f7 = @(x)(((x-xn(8))/(xn(7)-xn(8))).*((x-xn(8))/(xn(7)-xn(8))).*(1+2.*((x-xn(7))/(xn(8)-xn(7)))).*yn(7)+((x-xn(7))/(xn(8)-xn(7))).*((x-xn(7))/(xn(8)-xn(7))).*(1+2.*(x-xn(8))/(xn(7)-xn(8))).*yn(8)+((x-xn(8))/(xn(7)-xn(8))).*((x-xn(8))/(xn(7)-xn(8))).*(x-xn(7)).*y1(7)+((x-xn(7))/(xn(8)-xn(7))).*((x-xn(7))/(xn(8)-xn(7))).*(x-xn(8)).*y1(8));
f8 = @(x)(((x-xn(9))/(xn(8)-xn(9))).*((x-xn(9))/(xn(8)-xn(9))).*(1+2.*((x-xn(8))/(xn(9)-xn(8)))).*yn(8)+((x-xn(8))/(xn(9)-xn(8))).*((x-xn(8))/(xn(9)-xn(8))).*(1+2.*(x-xn(9))/(xn(8)-xn(9))).*yn(9)+((x-xn(9))/(xn(8)-xn(9))).*((x-xn(9))/(xn(8)-xn(9))).*(x-xn(8)).*y1(8)+((x-xn(8))/(xn(9)-xn(8))).*((x-xn(8))/(xn(9)-xn(8))).*(x-xn(9)).*y1(9));
f9 = @(x)(((x-xn(10))/(xn(9)-xn(10))).*((x-xn(10))/(xn(9)-xn(10))).*(1+2.*((x-xn(9))/(xn(10)-xn(9)))).*yn(9)+((x-xn(9))/(xn(10)-xn(9))).*((x-xn(9))/(xn(10)-xn(9))).*(1+2.*(x-xn(10))/(xn(9)-xn(10))).*yn(10)+((x-xn(10))/(xn(9)-xn(10))).*((x-xn(10))/(xn(9)-xn(10))).*(x-xn(9)).*y1(9)+((x-xn(9))/(xn(10)-xn(9))).*((x-xn(9))/(xn(10)-xn(9))).*(x-xn(10)).*y1(10));
f10 = @(x)(((x-xn(11))/(xn(10)-xn(11))).*((x-xn(11))/(xn(10)-xn(11))).*(1+2.*((x-xn(10))/(xn(11)-xn(10)))).*yn(10)+((x-xn(10))/(xn(11)-xn(10))).*((x-xn(10))/(xn(11)-xn(10))).*(1+2.*(x-xn(11))/(xn(10)-xn(11))).*yn(11)+((x-xn(11))/(xn(10)-xn(11))).*((x-xn(11))/(xn(10)-xn(11))).*(x-xn(10)).*y1(10)+((x-xn(10))/(xn(11)-xn(10))).*((x-xn(10))/(xn(11)-xn(10))).*(x-xn(11)).*y1(11));
for i=1:n
    if(xm(i)>-5&&xm(i)<=-4)
    y(i)=f1(xm(i));
    end
    if(xm(i)>-4&&xm(i)<=-3)
    y(i)=f2(xm(i));
    end
    if(xm(i)>-3&&xm(i)<=-2)
    y(i)=f3(xm(i));
    end
    if(xm(i)>-2&&xm(i)<=-1)
    y(i)=f4(xm(i));
    end
    if(xm(i)>-1&&xm(i)<=0)
    y(i)=f5(xm(i));
    end
    if(xm(i)>=0&&xm(i)<1)
    y(i)=f6(xm(i));
    end
    if(xm(i)>=1&&xm(i)<2)
    y(i)=f7(xm(i));
    end
    if(xm(i)>=2&&xm(i)<3)
    y(i)=f8(xm(i));
    end
    if(xm(i)>=3&&xm(i)<4)
    y(i)=f9(xm(i));
    end
    if(xm(i)>=4&&xm(i)<=5)
    y(i)=f10(xm(i));
    end
end
end

